exports.id=113,exports.ids=[113],exports.modules={8003:(e,a,t)=>{Promise.resolve().then(t.bind(t,99111))},61193:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>f});var s=t(60687);t(43210);var r=t(16189),n=t(84369),o=t(74911),i=t(11844),d=t(1679),c=t(7956),l=t(86622),u=t(11516),m=t(79272);function f({children:e}){let{user:a,loading:t,userProfile:f}=(0,n.A)();(0,r.useRouter)();let p=new Date().getFullYear(),b=f?.role==="admin";return!t&&a&&b?(0,s.jsx)(c.GB,{defaultOpen:!0,children:(0,s.jsxs)("div",{className:"flex min-h-screen bg-background text-foreground",children:[(0,s.jsxs)(c.Bx,{collapsible:"icon",className:"border-r bg-sidebar text-sidebar-foreground",children:[(0,s.jsx)(c.Gh,{className:"p-4",children:(0,s.jsx)(o.AppLogo,{colorVariant:"sidebar"})}),(0,s.jsx)(c.Yv,{className:"p-2",children:(0,s.jsx)(i.c,{isAdmin:!0})}),(0,s.jsx)(c.CG,{className:"p-4 border-t border-sidebar-border",children:(0,s.jsx)(l.c,{className:"w-full justify-start"})})]}),(0,s.jsxs)(c.sF,{className:"flex-1 flex flex-col",children:[" ",(0,s.jsxs)("header",{className:"sticky top-0 z-40 flex h-16 items-center justify-between border-b bg-background/95 px-4 sm:px-6 backdrop-blur supports-[backdrop-filter]:bg-background/60 md:justify-end",children:[(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)(c.x2,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,s.jsx)("span",{className:"text-sm font-semibold text-destructive",children:"ADMIN PANEL"}),(0,s.jsx)(m.U,{}),(0,s.jsx)(d.p,{})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:e}),(0,s.jsxs)("footer",{className:"p-4 text-center text-xs text-muted-foreground border-t border-border",children:["\xa9 ",p," Wohana Funds. All rights reserved."]})]})]})}):(0,s.jsxs)("div",{className:"flex h-screen items-center justify-center bg-background text-foreground",children:[(0,s.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:b||t||!a?"Loading...":"Access Denied. Redirecting..."})]})}},61483:(e,a,t)=>{"use strict";function s(e,a){if(null==e)return"N/A";let t=a||"USD";try{return new Intl.NumberFormat(void 0,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}catch(a){return console.warn(`Failed to format currency with code ${t}:`,a),`${t} ${e.toFixed(2)} (Format Error)`}}t.d(a,{V:()=>l,v:()=>s});let r=["John","Jane","Michael","Emily","David","Sarah","Chris","Jessica","James","Linda","Robert","Patricia","William","Jennifer","Richard","Mary","Charles","Susan","Joseph","Karen"],n=["Smith","Doe","Johnson","Williams","Brown","Davis","Miller","Wilson","Garcia","Rodriguez","Jones","Martinez","Taylor","Anderson","Thomas","Hernandez","Moore","Martin"],o=["Kenji","Sakura","Wei","Mei","Hiroshi","Yuki","Jin","Lien","Raj","Priya","Arjun","Ananya","Min-jun","Seo-yeon","Haruto","Aoi"],i=["Tanaka","Kim","Lee","Chen","Watanabe","Park","Nguyen","Singh","Gupta","Khan","Wang","Li","Zhang","Liu","Patel","Yamamoto"],d=["Hans","Sophie","Luca","Isabelle","Miguel","Clara","Pierre","Anna","Viktor","Elena","Giovanni","Maria","Jan","Eva","Liam","Olivia"],c=["M\xfcller","Dubois","Rossi","Garc\xeda","Silva","Jansen","Novak","Ivanov","Kowalski","Andersson","Schmidt","Martin","Fern\xe1ndez","Popescu"];function l(){let e,a;let t=Math.random();t<.33?(e=r,a=n):t<.66?(e=o,a=i):(e=d,a=c);let s=e[Math.floor(Math.random()*e.length)],l=a[Math.floor(Math.random()*a.length)];return`${s} ${l}`}},70121:(e,a,t)=>{"use strict";t.r(a),t.d(a,{"000ba8576fdcae11f1077fd2f6107481a50b69a49c":()=>r.J$,"00395e5e4b03385e5ff3a61827ff2eda7721f4e6fd":()=>r.Ns,"00cd6105122603e2abb19b24da9909a5b2be1fc510":()=>f,"00d3b7c7cd72c85ee48ae24fb4ba855eb43cfee9e5":()=>r.a0,"400312d3e27e1a3a7e375b9b4e21a4da853f5f9cf9":()=>S,"4020c28b5806231680bac26bd1a5f986057ba4604a":()=>r.ii,"4034cc97d27439f4c059c8a95b03da6fa61b86b0db":()=>s.u,"405eb9911f33c3d30f855e4f5a1527a24f42e6c294":()=>r.xk,"407b998a89b103b17288a19e879fdbf57b42a451fa":()=>r.R3,"4089fd580aa08b6e381398add21c3e6ca8660ff033":()=>F,"604312656f2004c1bcb55da4e8d649d32b089bca51":()=>s._,"60b1e2ff96f372e51b9fcb16237485e016caa935df":()=>r.FE,"60b77c7c1ccc1e649724f93088a00aecddd9374589":()=>A,"60cc029ed06a047da39ac67d9873228e1c42da5d46":()=>h,"60ff8321e9d694b897c700ee9ea58f57df8694f2ec":()=>r.yD,"7015f93f693f875a1cde63a9df10ec458edb2b9d08":()=>N,"7081db71fe6c604021ba3729a32f6b7f530e140d50":()=>p,"70918b3db47f128654f2868d514fdbe3da25273a17":()=>D,"70f7294112d7cf3ab36d93feeb3b0148aedfd029d6":()=>w,"788dce5c7e313de263852a29ef7863359de3d08ac6":()=>b,"78d1b94d424b0eff02e7f9428afdad6e3ba79375de":()=>P,"7caddbfe4718b11ca4234887401a8154a65d605707":()=>j,"7e96681ef909b91a10d9e85dc4e2d86abedd3d9f90":()=>g});var s=t(30677),r=t(2235),n=t(91199);t(42087);var o=t(20055),i=t(59652),d=t(7944),c=t(37036),l=t(37808),u=t(61483),m=t(33331);async function f(){try{let e=(0,i.rJ)(o.db,"users"),a=(0,i.rJ)(o.db,"kycData"),t=(0,i.rJ)(o.db,"loans"),s=(0,i.P)(e),r=(0,i.P)(a,(0,i._M)("status","==","pending_review")),n=(0,i.P)(t,(0,i._M)("status","==","active")),d=await (0,i.d_)(s),c=await (0,i.d_)(r),l=await (0,i.d_)(n),u={totalUsers:d.data().count,pendingKyc:c.data().count,activeLoans:l.data().count};return{success:!0,stats:u}}catch(e){return console.error("Error fetching admin dashboard stats:",e),{success:!1,error:"Failed to fetch dashboard statistics."}}}async function p(e,a,t){try{let a=(0,i.H9)(o.db,"loans",e),s={status:t};return"approved"===t?s.approvalDate=i.Dc.now():"paid"===t&&(s.paidDate=i.Dc.now()),await (0,i.mZ)(a,s),(0,d.revalidatePath)("/admin/loans"),(0,d.revalidatePath)("/dashboard/loans"),{success:!0,message:`Loan ${e} status updated to ${t}.`}}catch(e){return console.error("Error updating loan status:",e),{success:!1,message:"Failed to update loan status.",error:e.message}}}async function b(e,a,t,s){if(!e||!a||t<=0)return{success:!1,message:"Loan ID, User ID, and a positive loan amount are required."};try{let r=await (0,i.c4)(o.db,async r=>{let n=(0,i.H9)(o.db,"loans",e),d=(0,i.H9)(o.db,"users",a),c=await r.get(n),l=await r.get(d);if(!c.exists())throw Error("Loan application not found.");if(!l.exists())throw Error("User profile not found.");let u=c.data(),m=l.data();if("approved"!==u.status)throw Error("Loan must be in 'approved' status to be disbursed.");let f=m.balance||0,p=m.primaryCurrency||"USD",b=parseFloat((f+t).toFixed(2));r.update(d,{balance:b}),r.update(n,{status:"active",disbursedDate:i.Dc.now()});let h={userId:a,date:i.Dc.now(),description:`Loan disbursement (Loan ID: ${e})`,amount:t,type:"loan_disbursement",status:"completed",currency:s||p,relatedTransferId:e},g=(0,i.H9)((0,i.rJ)(o.db,"transactions"));return r.set(g,h),{transactionId:g.id,newBalance:b}});return(0,d.revalidatePath)("/admin/loans"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/admin/transactions"),(0,d.revalidatePath)("/dashboard/transactions"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:`Loan ${e} disbursed successfully. Amount: ${s||"$"}${t.toFixed(2)}. New balance: ${s||"$"}${r.newBalance.toFixed(2)}.`,transactionId:r.transactionId}}catch(e){return console.error("Error disbursing loan:",e),{success:!1,message:e.message||"Failed to disburse loan.",error:e.message}}}async function h(e,a){if(!a||"user"!==a&&"admin"!==a)return{success:!1,message:"Invalid role specified."};try{let t=(0,i.H9)(o.db,"users",e);return await (0,i.mZ)(t,{role:a}),(0,d.revalidatePath)("/admin/users"),{success:!0,message:`User ${e} role updated to ${a}.`}}catch(e){return console.error("Error updating user role:",e),{success:!1,message:"Failed to update user role.",error:e.message}}}async function g(e,a,t,r,n,c){if(!e||!a||!r)return{success:!1,message:"Missing required fields: User ID, Amount, or Description."};if(a<=0)return{success:!1,message:"Amount must be positive."};let l="credit"===t?a:-a,m="credit"===t?"manual_credit":"manual_debit";try{let f=await (0,i.c4)(o.db,async a=>{let s=(0,i.H9)(o.db,"users",e),d=await a.get(s);if(!d.exists())throw Error("Target user profile not found.");let u=d.data(),f=u.balance||0,p=u.primaryCurrency||"USD",b=parseFloat((f+l).toFixed(2));a.update(s,{balance:b});let h={userId:e,date:i.Dc.now(),description:r,amount:l,type:m,status:"completed",currency:n||p,notes:`Manual adjustment by admin: ${c||"System Action"}. Original input reason: ${r}`},g=(0,i.H9)((0,i.rJ)(o.db,"transactions"));return a.set(g,h),{transactionId:g.id,newBalance:b,userCurrency:n||p,userFullName:u.displayName||`${u.firstName} ${u.lastName}`.trim()||e,userEmail:u.email,transactionDate:h.date.toDate().toISOString(),accountNumber:u.accountNumber,adjustmentType:t}}),p=`Manual ${t} of ${f.userCurrency} ${a.toFixed(2)} for user ${f.userFullName} processed. New balance: ${f.userCurrency} ${f.newBalance.toFixed(2)}.`;if(f.userEmail){let e=new Date(f.transactionDate),a={fullName:f.userFullName,transactionAmount:(0,u.v)(Math.abs(l),f.userCurrency),transactionType:"credit"===f.adjustmentType?"Credit":"Debit",transactionDate:e.toLocaleDateString(),transactionTime:e.toLocaleTimeString(),transactionValueDate:e.toLocaleDateString(),transactionId:f.transactionId,transactionDescription:r,accountNumber:f.accountNumber?`******${f.accountNumber.slice(-4)}`:"N/A",currentBalance:(0,u.v)(f.newBalance,f.userCurrency),availableBalance:(0,u.v)(f.newBalance,f.userCurrency),transactionLocation:"Admin Platform",transactionRemarks:r,loginUrl:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:9002"}/dashboard/transactions`},n="credit"===f.adjustmentType?"CREDIT_NOTIFICATION":"DEBIT_NOTIFICATION";try{let e=await (0,s._)(n,a);e.html&&(0,s.u)({to:f.userEmail,subject:e.subject,htmlBody:e.html}).then(e=>{e.success||console.error(`Failed to send ${t} notification email for manual adjustment:`,e.error)})}catch(e){console.error(`Error preparing ${t} notification email for manual adjustment:`,e.message)}}return(0,d.revalidatePath)("/admin/financial-ops"),(0,d.revalidatePath)("/admin/transactions"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/dashboard/transactions"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:p,transactionId:f.transactionId}}catch(e){return console.error("Error during manual adjustment:",e),{success:!1,message:e.message||"Failed to issue manual adjustment.",error:e.message}}}let y=["Solutions","Group","Enterprises","Corp","Ltd.","Inc.","Global","Tech","Ventures","Industries","Systems","Logistics","Holdings","Partners","Dynamics"],v=["Global","Atlantic","Pacific","Euro","Asia","Ameri","International","Continental","Northern","Southern","Western","Eastern","Cyber","Nova","Quantum"],x=["Payment to","Received from","Invoice for","Services by","Consulting for","Purchase from","Refund from","Subscription to","Transfer to","Credit from","Market adjustment by","Processing fee for","Logistics for","Development of","Marketing for"],$=e=>e[Math.floor(Math.random()*e.length)];async function w(e,a,t){if(!e||a<=0)return{success:!1,message:"User ID and a positive count are required."};if(a>50)return{success:!1,message:"Cannot generate more than 50 transactions at once."};console.log(`generateRandomTransactionsAction: Starting for user ${e}, count: ${a}, targetNetValue: ${t}`);try{let s=(0,i.H9)(o.db,"users",e),r=await (0,i.x7)(s);if(!r.exists())return console.error(`generateRandomTransactionsAction: User profile not found for ${e}.`),{success:!1,message:"Target user profile not found."};let n=r.data(),c=n.primaryCurrency||"USD",l=n.balance||0;console.log(`generateRandomTransactionsAction: User ${e} initial balance: ${l} ${c}`);let m=(0,i.wP)(o.db),f=0,p=0;for(let s=0;s<a;s++){let r;let n=new Date,d=Math.floor(24*Math.random());if(n.setHours(n.getHours()-d),n.setMinutes(Math.floor(60*Math.random())),n.setSeconds(Math.floor(60*Math.random())),null!=t){let e=a-s,n=0;e>0&&(n=(t-f)/e);let o=.6*Math.random()+.7;r=parseFloat((n*o).toFixed(2)),s===a-1&&(r=parseFloat((t-f).toFixed(2)));let i=0===t?500:Math.abs(t)/Math.max(1,a/4)*1.5,d=0===t?-500:-(Math.abs(t)/Math.max(1,a/4)*1.5);r=Math.max(d,Math.min(i,r)),r=parseFloat(r.toFixed(2)),0===r&&0!==t&&a>1&&s<a-1&&(r=parseFloat(((.5>Math.random()?1:-1)*(50*Math.random()+5)).toFixed(2)))}else r=(495*Math.random()+5)*(.55>Math.random()?1:-1),r=parseFloat(r.toFixed(2));let l=r>0?$(["deposit","credit","manual_credit"]):$(["withdrawal","fee","debit","transfer","manual_debit"]),b=.4>Math.random()?`${$(v)} ${$(y)}`:(0,u.V)(),h=`${$(x)} ${b}`,g=100*Math.random(),w=g<95?"completed":g<98?"pending":"failed",A={userId:e,date:i.Dc.fromDate(n),description:h,amount:r,type:l,status:w,currency:c,isFlagged:.05>Math.random()};console.log(`generateRandomTransactionsAction: Generated tx ${s+1}: Amount: ${r}, Status: ${w}, Type: ${l}`);let N=(0,i.H9)((0,i.rJ)(o.db,"transactions"));m.set(N,A),p++,"completed"===w&&(f+=r,console.log(`generateRandomTransactionsAction: Tx ${s+1} is 'completed'. cumulativeAmountForCompletedTx updated to: ${f}`))}console.log(`generateRandomTransactionsAction: Total amount for 'completed' transactions: ${f}`);let b=parseFloat((l+f).toFixed(2));return console.log(`generateRandomTransactionsAction: Calculated new balance for ${c}: ${b}`),m.update(s,{balance:b}),console.log(`generateRandomTransactionsAction: Updating user doc with balance: ${b}. Added ${p} transaction sets to batch.`),await m.commit(),console.log(`generateRandomTransactionsAction: Batch committed successfully for user ${e}.`),(0,d.revalidatePath)("/admin/transactions"),(0,d.revalidatePath)("/admin/financial-ops"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/dashboard/transactions"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:`${p} random transactions generated for user ${n.displayName||e}. Balance updated by ${c} ${f.toFixed(2)} to ${c} ${b.toFixed(2)}.`,count:p}}catch(a){return console.error(`Error generating random transactions for user ${e}:`,a),{success:!1,message:"Failed to generate random transactions.",error:a.message}}}async function A(e,a){if(!e)return{success:!1,message:"User ID is required."};try{let t=(0,i.H9)(o.db,"users",e);if(await (0,i.mZ)(t,{isSuspended:a}),a){console.log(`updateUserSuspensionStatusAction: User ${e} is being suspended. Preparing email notification.`);let a=await (0,i.x7)(t);if(a.exists()){let t=a.data();if(t.email){let e=await (0,r.J$)(),a={fullName:t.displayName||t.firstName||"Customer",bankName:e.settings?.platformName||"Wohana Funds",emailLogoImageUrl:e.settings?.emailLogoImageUrl,supportEmail:e.settings?.supportEmail};console.log("updateUserSuspensionStatusAction: Email payload for suspension:",a);try{let e=await (0,s._)("ACCOUNT_SUSPENDED",a);e.html?(console.log(`updateUserSuspensionStatusAction: Attempting to send suspension email to ${t.email}. Subject: "${e.subject}"`),(0,s.u)({to:t.email,subject:e.subject,htmlBody:e.html,textBody:`Dear ${a.fullName}, your account with ${a.bankName} has been suspended. Please contact support at ${a.supportEmail} for more information.`}).then(e=>{e.success?console.log(`updateUserSuspensionStatusAction: Suspension email sent successfully to ${t.email}.`):console.error(`updateUserSuspensionStatusAction: Failed to send suspension email to ${t.email}: ${e.error}`)}).catch(e=>{console.error(`updateUserSuspensionStatusAction: Exception sending suspension email to ${t.email}:`,e)})):console.warn("updateUserSuspensionStatusAction: HTML content for ACCOUNT_SUSPENDED email was null or empty.")}catch(e){console.error(`updateUserSuspensionStatusAction: Error preparing suspension email content for ${t.email}:`,e.message,JSON.stringify(e,Object.getOwnPropertyNames(e)))}}else console.warn(`updateUserSuspensionStatusAction: User ${e} has no email. Cannot send suspension notification.`)}else console.warn(`updateUserSuspensionStatusAction: User profile for ${e} not found when trying to send suspension email.`)}return(0,d.revalidatePath)("/admin/users"),{success:!0,message:`User ${e} suspension status updated to ${a?"suspended":"active"}.`}}catch(e){return console.error("Error updating user suspension status:",e),{success:!1,message:"Failed to update user suspension status.",error:e.message}}}async function N(e,a,t){try{let n=(0,i.H9)(o.db,"kycData",e),c=(0,i.H9)(o.db,"users",a),l=await (0,i.x7)(c);if(!l.exists())return{success:!1,message:`User profile for ${a} not found.`};let u=l.data(),m={status:"verified",reviewedAt:i.Dc.now(),reviewedBy:t||"system_admin_placeholder",rejectionReason:""},f=(0,i.wP)(o.db);f.update(n,m),f.update(c,{kycStatus:"verified"}),await f.commit();let p=await (0,r.J$)(),b={fullName:u.displayName||u.firstName||"Customer",bankName:p.settings?.platformName||"Wohana Funds",emailLogoImageUrl:p.settings?.emailLogoImageUrl,loginUrl:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:9002"}/dashboard`};if(u.email)try{let e=await (0,s._)("KYC_APPROVED",b);e.html&&(0,s.u)({to:u.email,subject:e.subject,htmlBody:e.html,textBody:`Congratulations ${b.fullName}, your KYC has been approved. You now have full access. - The ${b.bankName} Team.`}).then(e=>{e.success||console.error("Failed to send KYC approved email:",e.error)})}catch(e){console.error("Error preparing/sending KYC approved email:",e.message)}return(0,d.revalidatePath)("/admin/kyc"),(0,d.revalidatePath)("/dashboard/kyc"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:`KYC for user ${a} approved.`}}catch(e){return console.error("Error approving KYC:",e),{success:!1,message:"Failed to approve KYC.",error:e.message}}}async function P(e,a,t,n){if(!t.trim())return{success:!1,message:"Rejection reason is required."};try{let c=(0,i.H9)(o.db,"kycData",e),l=(0,i.H9)(o.db,"users",a),u=await (0,i.x7)(l);if(!u.exists())return{success:!1,message:`User profile for ${a} not found.`};let m=u.data(),f={status:"rejected",rejectionReason:t,reviewedAt:i.Dc.now(),reviewedBy:n||"system_admin_placeholder"},p=(0,i.wP)(o.db);p.update(c,f),p.update(l,{kycStatus:"rejected"}),await p.commit();let b=await (0,r.J$)(),h={fullName:m.displayName||m.firstName||"Customer",bankName:b.settings?.platformName||"Wohana Funds",emailLogoImageUrl:b.settings?.emailLogoImageUrl,kycRejectionReason:t,loginUrl:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:9002"}/dashboard/kyc`};if(m.email)try{let e=await (0,s._)("KYC_REJECTED",h);e.html&&(0,s.u)({to:m.email,subject:e.subject,htmlBody:e.html,textBody:`Dear ${h.fullName}, your KYC submission was rejected. Reason: ${t}. Please resubmit. - The ${h.bankName} Team.`}).then(e=>{e.success||console.error("Failed to send KYC rejected email:",e.error)})}catch(e){console.error("Error preparing/sending KYC rejected email:",e.message)}return(0,d.revalidatePath)("/admin/kyc"),(0,d.revalidatePath)("/dashboard/kyc"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:`KYC for user ${a} rejected.`}}catch(e){return console.error("Error rejecting KYC:",e),{success:!1,message:"Failed to reject KYC.",error:e.message}}}async function D(e,a,t){if(!e||!a)return{success:!1,message:"Transaction ID and User ID are required."};try{return await (0,i.c4)(o.db,async s=>{let r=(0,i.H9)(o.db,"transactions",e),n=(0,i.H9)(o.db,"users",a),d=await s.get(r),c=await s.get(n);if(!d.exists())throw Error("Transaction not found.");if(!c.exists())throw Error("User profile not found.");let l=d.data();if("pending"!==l.status)throw Error("Only pending transactions can be marked as completed.");let u=c.data().balance||0,m=parseFloat((u+t).toFixed(2));s.update(n,{balance:m}),s.update(r,{status:"completed",updatedAt:i.Dc.now()})}),(0,d.revalidatePath)("/admin/transactions"),(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/dashboard/transactions"),(0,d.revalidatePath)("/dashboard"),(0,d.revalidatePath)("/dashboard/profile"),{success:!0,message:`Transaction ${e} marked as completed and balance updated.`}}catch(e){return console.error("Error marking transaction as completed:",e),{success:!1,message:e.message||"Failed to mark transaction as completed.",error:e.message}}}async function F(e){let a=c.bw.safeParse(e);if(!a.success)return{success:!1,message:"Invalid user data.",error:a.error.flatten().fieldErrors};let{email:t,password:s,firstName:r,lastName:n,phoneNumber:u,accountType:m,currency:f,role:p}=a.data,b=null;try{let e=(b=(await (0,l.eJ)(o.j2,t,s)).user).uid,a=(0,i.H9)(o.db,"users",e),c=Math.floor(1e9+9e9*Math.random()).toString(),h=`${r} ${n}`;return await (0,i.BN)(a,{uid:e,email:t,firstName:r,lastName:n,displayName:h,photoURL:null,phoneNumber:u||void 0,accountType:m||"default_user_type",balance:0,primaryCurrency:f||"USD",kycStatus:"not_started",role:p||"user",accountNumber:c,isFlagged:!1,accountHealthScore:75,profileCompletionPercentage:50,isSuspended:!1}),(0,d.revalidatePath)("/admin/users"),{success:!0,message:"User created successfully.",userId:e}}catch(a){if(console.error("Error in adminAddUserAction:",a),b&&b.delete)try{await (0,l.hG)(b)}catch(e){console.error("AdminAddUserAction: CRITICAL - Failed to roll back Firebase Auth user:",e)}let e="Failed to create user.";return"auth/email-already-in-use"===a.code?e="This email is already registered.":a.message&&(e=a.message),{success:!1,message:e,error:a.message}}}async function S(e){if(!e)return{success:!1,message:"User ID is required for deletion."};try{let a=(0,i.wP)(o.db),t=(0,i.H9)(o.db,"users",e);a.delete(t);let s=(0,i.H9)(o.db,"kycData",e);return(await (0,i.x7)(s)).exists()&&a.delete(s),await a.commit(),(0,d.revalidatePath)("/admin/users"),{success:!0,message:`User profile (ID: ${e}) and associated KYC data deleted from Firestore successfully. Firebase Auth record must be deleted separately.`}}catch(a){return console.error(`Error deleting user data for UID ${e} from Firestore:`,a),{success:!1,message:"Failed to delete user data from Firestore.",error:a.message}}}async function j(e,a,t="Admin",s,r){if(!e||!a.trim())return{success:!1,message:"Ticket ID and reply text are required."};try{let n=(0,i.H9)(o.db,"supportTickets",e),c={id:(0,i.H9)((0,i.rJ)(o.db,"dummy")).id,authorId:s||"admin_system",authorName:t,authorRole:"admin",message:a.trim(),timestamp:(0,i.O5)()},l={updatedAt:(0,i.O5)(),replies:(0,i.hq)(c)};if(r)l.status=r;else{let e=await (0,i.x7)(n);if(e.exists()){let a=e.data();("open"===a.status||"pending_admin_reply"===a.status)&&(l.status="pending_user_reply")}}return await (0,i.mZ)(n,l),(0,d.revalidatePath)("/admin/support"),{success:!0,message:"Reply sent and ticket updated."}}catch(e){return console.error("Error replying to support ticket:",e),{success:!1,message:"Failed to send reply.",error:e.message}}}(0,m.D)([f,p,b,h,g,w,A,N,P,D,F,S,j]),(0,n.A)(f,"00cd6105122603e2abb19b24da9909a5b2be1fc510",null),(0,n.A)(p,"7081db71fe6c604021ba3729a32f6b7f530e140d50",null),(0,n.A)(b,"788dce5c7e313de263852a29ef7863359de3d08ac6",null),(0,n.A)(h,"60cc029ed06a047da39ac67d9873228e1c42da5d46",null),(0,n.A)(g,"7e96681ef909b91a10d9e85dc4e2d86abedd3d9f90",null),(0,n.A)(w,"70f7294112d7cf3ab36d93feeb3b0148aedfd029d6",null),(0,n.A)(A,"60b77c7c1ccc1e649724f93088a00aecddd9374589",null),(0,n.A)(N,"7015f93f693f875a1cde63a9df10ec458edb2b9d08",null),(0,n.A)(P,"78d1b94d424b0eff02e7f9428afdad6e3ba79375de",null),(0,n.A)(D,"70918b3db47f128654f2868d514fdbe3da25273a17",null),(0,n.A)(F,"4089fd580aa08b6e381398add21c3e6ca8660ff033",null),(0,n.A)(S,"400312d3e27e1a3a7e375b9b4e21a4da853f5f9cf9",null),(0,n.A)(j,"7caddbfe4718b11ca4234887401a8154a65d605707",null)},73659:(e,a,t)=>{Promise.resolve().then(t.bind(t,61193))},99111:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let s=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/george/Desktop/projects/alobam-bank/src/app/admin/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/george/Desktop/projects/alobam-bank/src/app/admin/layout.tsx","default")}};
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1490],{15300:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},17607:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},28294:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]])},37648:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},44558:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},54165:(e,a,t)=>{"use strict";t.d(a,{Cf:()=>h,Es:()=>m,HM:()=>x,L3:()=>j,c7:()=>p,lG:()=>c,rr:()=>y,zM:()=>d});var s=t(95155),i=t(12115),l=t(15452),r=t(25318),n=t(59434);let c=l.bL,d=l.l9,o=l.ZL,x=l.bm,u=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(l.hJ,{ref:a,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...i})});u.displayName=l.hJ.displayName;let h=i.forwardRef((e,a)=>{let{className:t,children:i,...c}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(l.UC,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[i,(0,s.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(r.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=l.UC.displayName;let p=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};p.displayName="DialogHeader";let m=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};m.displayName="DialogFooter";let j=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(l.hE,{ref:a,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",t),...i})});j.displayName=l.hE.displayName;let y=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(l.VY,{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",t),...i})});y.displayName=l.VY.displayName},55166:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]])},56104:(e,a,t)=>{"use strict";let s;t.d(a,{db:()=>u,j2:()=>x});var i=t(23915),l=t(93004),r=t(35317),n=t(90858);let c="AIzaSyDDSfTetLVLe0LwCB-070TnJCk0eL5keRg",d="alobam-bank.firebaseapp.com",o="alobam-bank";if(!c)throw Error("Firebase API Key is missing. Please ensure NEXT_PUBLIC_FIREBASE_API_KEY is set correctly in your .env file and that the development server was restarted.");if(!d)throw Error("Firebase Auth Domain is missing. Please ensure NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN is set correctly in your .env file and that the development server was restarted.");o||console.warn("Firebase Project ID (NEXT_PUBLIC_FIREBASE_PROJECT_ID) is not set. This might cause issues with some Firebase services."),s=(0,i.Dk)().length?(0,i.Sx)():(0,i.Wp)({apiKey:c,authDomain:d,projectId:o,storageBucket:"alobam-bank.firebasestorage.app",messagingSenderId:"21187336200",appId:"1:21187336200:web:83b0e0c311f5d9820219bd"});let x=(0,l.xI)(s),u=(0,r.aU)(s);(0,n.c7)(s)},72169:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>H});var s=t(95155),i=t(66695),l=t(30285),r=t(62523),n=t(85127),c=t(26126),d=t(55166),o=t(75074),x=t(50172),u=t(31949),h=t(17607),p=t(8376),m=t(24371),j=t(88390),y=t(12115),v=t(35317),f=t(56104),g=t(55365),N=t(34477);let b=(0,N.createServerReference)("7081db71fe6c604021ba3729a32f6b7f530e140d50",N.callServer,void 0,N.findSourceMapURL,"updateLoanStatusAction"),A=(0,N.createServerReference)("788dce5c7e313de263852a29ef7863359de3d08ac6",N.callServer,void 0,N.findSourceMapURL,"disburseLoanAction");var w=t(87481),k=t(54165),D=t(85057),L=t(44558),E=t(28294),I=t(37648),S=t(97723),C=t(98328),M=t(15300);let R=e=>{let{status:a}=e;switch(a){case"pending":return(0,s.jsx)(c.E,{variant:"secondary",className:"bg-yellow-500 text-black",children:"Pending"});case"approved":return(0,s.jsx)(c.E,{className:"bg-blue-500 text-white",children:"Approved"});case"rejected":return(0,s.jsx)(c.E,{variant:"destructive",children:"Rejected"});case"active":return(0,s.jsx)(c.E,{className:"bg-green-500 text-white",children:"Active"});case"paid":return(0,s.jsx)(c.E,{variant:"outline",children:"Paid"});case"defaulted":return(0,s.jsx)(c.E,{variant:"destructive",className:"bg-red-700 text-white",children:"Defaulted"});default:return(0,s.jsx)(c.E,{variant:"outline",children:a})}},P=e=>{let{label:a,value:t,icon:i}=e;return(0,s.jsxs)("div",{className:"py-2",children:[(0,s.jsxs)(D.Label,{className:"text-xs font-semibold text-muted-foreground flex items-center",children:[i,a]}),(0,s.jsx)("p",{className:"text-sm break-words",children:null==t||""===t?"N/A":String(t)})]})},_=e=>{let a;if(!e)return"N/A";if("object"==typeof e&&"toDate"in e&&"function"==typeof e.toDate)a=e.toDate();else{if(!(e instanceof Date))return"Invalid Date";a=e}return a.toLocaleDateString()};function z(e){let{isOpen:a,onOpenChange:t,loan:i}=e;return i?(0,s.jsx)(k.lG,{open:a,onOpenChange:t,children:(0,s.jsxs)(k.Cf,{className:"sm:max-w-lg",children:[(0,s.jsxs)(k.c7,{children:[(0,s.jsxs)(k.L3,{children:["Loan Application Details: ",i.id]}),(0,s.jsxs)(k.rr,{children:["Viewing details for loan application by ",i.applicantName||i.userId,"."]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 py-4 max-h-[60vh] overflow-y-auto pr-2",children:[(0,s.jsx)(P,{icon:(0,s.jsx)(L.A,{className:"mr-2 h-4 w-4"}),label:"Loan ID",value:i.id}),(0,s.jsx)(P,{icon:(0,s.jsx)(E.A,{className:"mr-2 h-4 w-4"}),label:"Applicant Name",value:i.applicantName}),(0,s.jsx)(P,{icon:(0,s.jsx)(E.A,{className:"mr-2 h-4 w-4"}),label:"User ID",value:i.userId}),(0,s.jsx)(P,{icon:(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"}),label:"Loan Amount",value:"$".concat(i.amount.toLocaleString())}),(0,s.jsx)(P,{icon:(0,s.jsx)(I.A,{className:"mr-2 h-4 w-4"}),label:"Term",value:"".concat(i.termMonths," months")}),(0,s.jsx)(P,{icon:(0,s.jsx)(S.A,{className:"mr-2 h-4 w-4"}),label:"Interest Rate",value:"".concat((100*i.interestRate).toFixed(2),"%")}),(0,s.jsxs)("div",{className:"py-2",children:[(0,s.jsxs)(D.Label,{className:"text-xs font-semibold text-muted-foreground flex items-center",children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Status"]}),(0,s.jsx)(R,{status:i.status})]}),(0,s.jsx)(P,{icon:(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4"}),label:"Application Date",value:_(i.applicationDate)}),i.approvalDate&&(0,s.jsx)(P,{icon:(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4"}),label:"Approval Date",value:_(i.approvalDate)}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(P,{icon:(0,s.jsx)(M.A,{className:"mr-2 h-4 w-4"}),label:"Purpose",value:i.purpose})})]}),(0,s.jsx)(k.Es,{children:(0,s.jsx)(k.HM,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"outline",children:"Close"})})})]})}):null}let F=e=>{let{status:a}=e;switch(a){case"pending":return(0,s.jsx)(c.E,{variant:"secondary",className:"bg-yellow-500 text-black",children:"Pending"});case"approved":return(0,s.jsx)(c.E,{className:"bg-blue-500 hover:bg-blue-600 text-white",children:"Approved"});case"rejected":return(0,s.jsx)(c.E,{variant:"destructive",children:"Rejected"});case"active":return(0,s.jsx)(c.E,{className:"bg-green-500 hover:bg-green-600 text-white",children:"Active"});case"paid":return(0,s.jsx)(c.E,{variant:"outline",children:"Paid"});case"defaulted":return(0,s.jsx)(c.E,{variant:"destructive",className:"bg-red-700 hover:bg-red-800",children:"Defaulted"});default:return(0,s.jsx)(c.E,{variant:"outline",children:a})}},T=e=>{let a;if(!e)return"N/A";if((null==e?void 0:e.toDate)&&"function"==typeof e.toDate)a=e.toDate();else if(e instanceof Date)a=e;else try{let t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";a=t}catch(e){return"Invalid Date"}return a.toLocaleDateString()};function H(){let{toast:e}=(0,w.dj)(),[a,t]=(0,y.useState)([]),[c,N]=(0,y.useState)(""),[k,D]=(0,y.useState)(!0),[L,E]=(0,y.useState)(null),[I,S]=(0,y.useState)(null),[C,M]=(0,y.useState)(null),[R,P]=(0,y.useState)(!1),[_,H]=(0,y.useState)(null),B=async()=>{D(!0),E(null);try{let e=(0,v.rJ)(f.db,"loans"),a=(0,v.P)(e,(0,v.My)("applicationDate","desc")),s=await (0,v.GG)(a),i=[];s.forEach(e=>{let a=e.data(),t=e=>{if(e){if(null==e?void 0:e.toDate)return e.toDate();if(e instanceof Date)return e;try{let a=new Date(e);return isNaN(a.getTime())?void 0:a}catch(e){return}}};i.push({id:e.id,...a,applicationDate:t(a.applicationDate)||new Date,approvalDate:t(a.approvalDate),disbursedDate:t(a.disbursedDate),paidDate:t(a.paidDate)})}),t(i)}catch(e){console.error("Error fetching loans:",e),E("Failed to fetch loan applications. Please try again.")}finally{D(!1)}};(0,y.useEffect)(()=>{B()},[]);let U=e=>{H(e),P(!0)},$=async(a,t,s)=>{S(a);let i=await b(a,t,s);i.success?(e({title:"Success",description:i.message}),B()):e({title:"Error",description:i.message||"Failed to update loan status.",variant:"destructive"}),S(null)},q=async a=>{M(a.id);let t=await A(a.id,a.userId,a.amount,a.currency);t.success?(e({title:"Success",description:t.message}),B()):e({title:"Error",description:t.message||"Failed to disburse loan.",variant:"destructive"}),M(null)},O=a.filter(e=>{var a;return(null===(a=e.applicantName)||void 0===a?void 0:a.toLowerCase().includes(c.toLowerCase()))||e.id.toLowerCase().includes(c.toLowerCase())||e.userId.toLowerCase().includes(c.toLowerCase())});return(0,s.jsxs)("div",{className:"w-full space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,s.jsx)(d.A,{className:"mr-2 h-8 w-8 text-primary"}),"Manage Loan Applications"]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Review, approve, disburse, or reject loan applications."})]})}),(0,s.jsxs)(i.Zp,{className:"shadow-lg",children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsxs)(i.ZB,{children:["Loan Applications (",k?"Loading...":O.length,")"]}),(0,s.jsx)(i.BT,{children:"Review and process loan applications."}),(0,s.jsx)("div",{className:"pt-4 flex gap-2 items-center",children:(0,s.jsxs)("div",{className:"relative flex-grow max-w-md",children:[(0,s.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(r.p,{placeholder:"Search by applicant, loan ID, user ID...",className:"pl-10",value:c,onChange:e=>N(e.target.value)})]})})]}),(0,s.jsx)(i.Wu,{children:k?(0,s.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,s.jsx)(x.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading loan applications..."})]}):L?(0,s.jsxs)(g.Fc,{variant:"destructive",className:"my-4",children:[(0,s.jsx)(u.A,{className:"h-4 w-4"}),(0,s.jsx)(g.XL,{children:"Error Loading Loans"}),(0,s.jsx)(g.TN,{children:L})]}):0!==O.length||c?0===O.length&&c?(0,s.jsxs)("p",{className:"text-muted-foreground text-center py-8",children:['No loans match your search for "',c,'".']}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(n.XI,{children:[(0,s.jsx)(n.A0,{children:(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nd,{children:"Loan ID"}),(0,s.jsx)(n.nd,{children:"Applicant"}),(0,s.jsx)(n.nd,{children:"Amount"}),(0,s.jsx)(n.nd,{children:"Term"}),(0,s.jsx)(n.nd,{children:"Applied"}),(0,s.jsx)(n.nd,{children:"Disbursed"}),(0,s.jsx)(n.nd,{children:"Paid"}),(0,s.jsx)(n.nd,{children:"Status"}),(0,s.jsx)(n.nd,{className:"text-center",children:"Actions"})]})}),(0,s.jsx)(n.BF,{children:O.map(e=>(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nA,{className:"font-mono text-xs",children:e.id}),(0,s.jsxs)(n.nA,{children:[(0,s.jsx)("div",{children:e.applicantName||"N/A"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.userId})]}),(0,s.jsxs)(n.nA,{children:["$",e.amount.toLocaleString()]}),(0,s.jsxs)(n.nA,{children:[e.termMonths," months"]}),(0,s.jsx)(n.nA,{children:T(e.applicationDate)}),(0,s.jsx)(n.nA,{children:T(e.disbursedDate)}),(0,s.jsx)(n.nA,{children:T(e.paidDate)}),(0,s.jsx)(n.nA,{children:(0,s.jsx)(F,{status:e.status})}),(0,s.jsxs)(n.nA,{className:"text-center space-x-1",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",title:"View Details",onClick:()=>U(e),children:(0,s.jsx)(h.A,{className:"h-4 w-4"})}),"pending"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-700",title:"Approve Loan",onClick:()=>$(e.id,e.userId,"approved"),disabled:I===e.id||C===e.id,children:I===e.id&&"pending"===e.status?(0,s.jsx)(x.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",title:"Reject Loan",onClick:()=>$(e.id,e.userId,"rejected"),disabled:I===e.id||C===e.id,children:I===e.id&&"pending"===e.status?(0,s.jsx)(x.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(m.A,{className:"h-4 w-4"})})]}),"approved"===e.status&&(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-blue-600 hover:text-blue-700",title:"Disburse Loan",onClick:()=>q(e),disabled:C===e.id||I===e.id,children:C===e.id?(0,s.jsx)(x.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(j.A,{className:"h-4 w-4"})}),"active"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-700",title:"Mark as Paid",onClick:()=>$(e.id,e.userId,"paid"),disabled:I===e.id||C===e.id,children:I===e.id&&"active"===e.status?(0,s.jsx)(x.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",title:"Mark as Defaulted",onClick:()=>$(e.id,e.userId,"defaulted"),disabled:I===e.id||C===e.id,children:I===e.id&&"active"===e.status?(0,s.jsx)(x.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(m.A,{className:"h-4 w-4"})})]})]})]},e.id))})]})}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No loan applications found."})})]}),_&&(0,s.jsx)(z,{isOpen:R,onOpenChange:P,loan:_})]})}},75074:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},77466:(e,a,t)=>{Promise.resolve().then(t.bind(t,72169))},88390:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},97723:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]])},98328:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,6073,5511,3787,4602,1263,4443,1132,8441,1684,7358],()=>a(77466)),_N_E=e.O()}]);